<div class="register">
  <div class="headline">Register an Account</div>

  <form [formGroup]="form" (ngSubmit)="onSubmit()">
    <!-- Username field -->
    <div class="input-field">
      <input
        formControlName="username"
        type="text"
        id="username"
        name="username"
        autocomplete="username"
        (focus)="usernameFieldFocused = true"
        (blur)="usernameFieldFocused = false"
        [ngClass]="usernameInputClasses"
        [attr.aria-describedby]="
          getFormErrors('username').length ? 'username-errors' : null
        "
        required
      />

      <!-- Static username icon -->
      <img
        class="icon icon--base"
        src="./assets/img/form/person.svg"
        alt="username icon"
        [ngClass]="usernameInputClasses"
      />

      @if (form.controls['username'].valid) {
      <!-- Success icon -->
      <img
        class="icon icon--status"
        src="./assets/img/form/success.svg"
        alt="valid input"
      />
      } @else if (getFormErrors('username').length > 0) {
      <!-- Error icon -->
      <img
        class="icon icon--status"
        src="./assets/img/form/error.svg"
        alt="invalid input"
      />
      }

      <label for="email" [ngClass]="usernameInputClasses"> Username </label>
    </div>

    <div
      id="email-errors"
      class="error-wrapper"
      role="alert"
      aria-live="assertive"
    >
      <!-- Frontend username error message -->
      @if (getFormErrors('username').length) {
      <div class="error-message">
        @for (error of getFormErrors('username'); track $index) {
        <p>{{ error }}</p>
        }
      </div>
      }
    </div>

    <!-- Email field -->
    <div class="input-field">
      <input
        formControlName="email"
        type="email"
        id="email"
        name="email"
        autocomplete="email"
        (focus)="emailFieldFocused = true"
        (blur)="emailFieldFocused = false"
        [ngClass]="emailInputClasses"
        [attr.aria-describedby]="
          getFormErrors('email').length ? 'email-errors' : null
        "
        required
      />

      <!-- Static email icon -->
      <img
        class="icon icon--base"
        src="./assets/img/form/email.svg"
        alt="email icon"
        [ngClass]="emailInputClasses"
      />

      @if (form.controls['email'].valid) {
      <!-- Success icon -->
      <img
        class="icon icon--status"
        src="./assets/img/form/success.svg"
        alt="valid input"
      />
      } @else if (getFormErrors('email').length > 0) {
      <!-- Error icon -->
      <img
        class="icon icon--status"
        src="./assets/img/form/error.svg"
        alt="invalid input"
      />
      }

      <label for="email" [ngClass]="emailInputClasses"> Email Address </label>
    </div>

    <div
      id="email-errors"
      class="error-wrapper"
      role="alert"
      aria-live="assertive"
    >
      <!-- Frontend email error message -->
      @if (getFormErrors('email').length) {
      <div class="error-message">
        @for (error of getFormErrors('email'); track $index) {
        <p>{{ error }}</p>
        }
      </div>
      }
    </div>

    <!-- Password field -->
    <div class="input-field">
      <input
        formControlName="password"
        type="password"
        id="password"
        name="password"
        autocomplete="password"
        (focus)="passwordFieldFocused = true"
        (blur)="passwordFieldFocused = false"
        [ngClass]="passwordInputClasses"
        [attr.aria-describedby]="
          getFormErrors('password').length ? 'password-errors' : null
        "
        required
      />

      <!-- Static password icon -->
      <img
        class="icon icon--base"
        src="./assets/img/form/password.svg"
        alt="password icon"
        [ngClass]="passwordInputClasses"
      />

      @if (form.controls['password'].valid) {
      <!-- Success icon -->
      <img
        class="icon icon--status"
        src="./assets/img/form/success.svg"
        alt="valid input"
      />
      } @else if (getFormErrors('password').length > 0) {
      <!-- Error icon -->
      <img
        class="icon icon--status"
        src="./assets/img/form/error.svg"
        alt="invalid input"
      />
      }

      <label for="password" [ngClass]="passwordInputClasses"> Password </label>
    </div>

    <div
      id="password-errors"
      class="error-wrapper"
      role="alert"
      aria-live="assertive"
    >
      <!-- Frontend password error message -->
      @if (getFormErrors('password').length) {
      <div class="error-message">
        @for (error of getFormErrors('password'); track $index) {
        <p>{{ error }}</p>
        }
      </div>
      }
    </div>

    <!-- Confirm password field -->
    <div class="input-field">
      <input
        formControlName="confirmPassword"
        type="password"
        id="confirmPassword"
        name="confirmPassword"
        autocomplete="confirm-password"
        (focus)="confirmPasswordFieldFocused = true"
        (blur)="confirmPasswordFieldFocused = false"
        [ngClass]="confirmPasswordInputClasses"
        [attr.aria-describedby]="
          getFormErrors('confirmPassword').length
            ? 'confirm-password-errors'
            : null
        "
        required
      />

      <!-- Static confirm password icon -->
      <img
        class="icon icon--base"
        src="./assets/img/form/password.svg"
        alt="password icon"
        [ngClass]="confirmPasswordInputClasses"
      />

      @if (form.controls['confirmPassword'].valid) {
      <!-- Success icon -->
      <img
        class="icon icon--status"
        src="./assets/img/form/success.svg"
        alt="valid input"
      />
      } @else if (getFormErrors('confirmPassword').length > 0) {
      <!-- Error icon -->
      <img
        class="icon icon--status"
        src="./assets/img/form/error.svg"
        alt="invalid input"
      />
      }

      <label for="confirmPassword" [ngClass]="confirmPasswordInputClasses">
        Confirm Password
      </label>
    </div>

    <div
      id="password-errors"
      class="error-wrapper"
      role="alert"
      aria-live="assertive"
    >
      <!-- Frontend confirm password error message -->
      @if (getFormErrors('confirmPassword').length) {
      <div class="error-message">
        @for (error of getFormErrors('confirmPassword'); track $index) {
        <p>{{ error }}</p>
        }
      </div>
      }
    </div>

    <!-- Register button -->
    <div class="button-container">
      <app-primary-button
        type="submit"
        value="Sign Up"
        [loading]="isSignUpLoading"
        [loadingMessage]="'Signing Up...'"
        [disabled]="isSignUpButtonDisabled"
      >
      </app-primary-button>
    </div>
  </form>
</div>
